const data = {
  '99_names': {
    roman: [
      'Ar-Rahman',
      'Ar-Raheem',
      'Al-Malik',
      'Al-Quddus',
      'As-Salam',
      "Al-Mu'min",
      'Al-Muhaymin',
      'Al-Aziz',
      'Al-Jabbar',
      'Al-Mutakabbir',
      'Al-Khaliq',
      "Al-Bari'",
      'Al-Musawwir',
      'Al-Ghaffar',
      'Al-Qahhar',
      'Al-Wahhab',
      'Ar-Razzaq',
      'Al-Fattah',
      'Al-Alim',
      'Al-Qabid',
      'Al-Basit',
      'Al-Khafidh',
      'Ar-Rafi',
      "Al-Mu'izz",
      'Al-Muzil',
      'Al-Sami',
      'Al-Basir',
      'Al-Hakam',
      'Al-Adl',
      'Al-Latif',
      'Al-Khabir',
      'Al-Halim',
      'Al-Azim',
      'Al-Ghafur',
      'Ash-Shakur',
      'Al-Ali',
      'Al-Kabir',
      'Al-Hafiz',
      'Al-Muqit',
      'Al-Hasib',
      'Al-Jalil',
      'Al-Karim',
      'Ar-Raqib',
      'Al-Mujib',
      'Al-Wasi',
      'Al-Hakim',
      'Al-Wadud',
      'Al-Majid',
      "Al-Ba'ith",
      'Ash-Shahid',
      'Al-Haqq',
      'Al-Wakil',
      'Al-Qawiyy',
      'Al-Matin',
      'Al-Wali',
      'Al-Hamid',
      'Al-Muhsi',
      'Al-Mubdi',
      "Al-Mu'id",
      'Al-Muhyi',
      'Al-Mumit',
      'Al-Hayy',
      'Al-Qayyum',
      'Al-Wajid',
      'Al-Majid',
      'Al-Wahid',
      'Al-Ahad',
      'As-Samad',
      'Al-Qadir',
      'Al-Muqtadir',
      'Al-Muqaddim',
      "Al-Mu'akhkhir",
      'Al-Awwal',
      'Al-Akhir',
      'Az-Zahir',
      'Al-Batin',
      'Al-Wali',
      "Al-Muta'ali",
      'Al-Barr',
      'At-Tawwab',
      'Al-Muntaqim',
      "Al-'Afuww",
      "Ar-Ra'uf",
      'Malik al-Mulk',
      'Dhu al-Jalali wa al-Ikram',
      'Al-Muqsit',
      'Al-Jami',
      'Al-Ghani',
      'Al-Mughni',
      "Al-Mani'",
      'Ad-Darr',
      "An-Nafi'",
      'An-Nur',
      'Al-Hadi',
      "Al-Badi'",
      'Al-Baqi',
      'Al-Warith',
      'Ar-Rashid',
      'As-Sabur',
    ],
    urdu: [
      'الرَّحْمَنُ',
      'الرَّحِيمُ',
      'الْمَلِكُ',
      'الْقُدُّوسُ',
      'السَّلاَمُ',
      'الْمُؤْمِنُ',
      'الْمُهَيْمِنُ',
      'الْعَزِيزُ',
      'الْجَبَّارُ',
      'الْمُتَكَبِّرُ',
      'الْخَالِقُ',
      'الْبَارِئُ',
      'الْمُصَوِّرُ',
      'الْغَفَّارُ',
      'الْقَهَّارُ',
      'الْوَهَّابُ',
      'الرَّزَّاقُ',
      'الْفَتَّاحُ',
      'اَلْعَلِيمُ',
      'الْقَابِضُ',
      'الْبَاسِطُ',
      'الْخَافِضُ',
      'الرَّافِعُ',
      'الْمُعِزُّ',
      'المُذِلُّ',
      'السَّمِيعُ',
      'الْبَصِيرُ',
      'الْحَكَمُ',
      'الْعَدْلُ',
      'اللَّطِيفُ',
      'الْخَبِيرُ',
      'الْحَلِيمُ',
      'الْعَظِيمُ',
      'الْغَفُورُ',
      'الشَّكُورُ',
      'الْعَلِيُّ',
      'الْكَبِيرُ',
      'الْحَفِيظُ',
      'المُقيِت',
      'الْحسِيبُ',
      'الْجَلِيلُ',
      'الْكَرِيمُ',
      'الرَّقِيبُ',
      'الْمُجِيبُ',
      'الْوَاسِعُ',
      'الْحَكِيمُ',
      'الْوَدُودُ',
      'الْمَجِيدُ',
      'الْبَاعِثُ',
      'الشَّهِيدُ',
      'الْحَقُّ',
      'الْوَكِيلُ',
      'الْقَوِيُّ',
      'الْمَتِينُ',
      'الْوَلِيُّ',
      'الْحَمِيدُ',
      'الْمُحْصِي',
      'الْمُبْدِئُ',
      'الْمُعِيدُ',
      'الْمُحْيِي',
      'اَلْمُمِيتُ',
      'الْحَيُّ',
      'الْقَيُّومُ',
      'الْوَاجِدُ',
      'الْمَاجِدُ',
      'الْوَاحِدُ',
      'الْأَحَدُ',
      'الصَّمَدُ',
      'الْقَادِرُ',
      'الْمُقْتَدِرُ',
      'الْمُقَدِّمُ',
      'الْمُؤَخِّرُ',
      'الأوَّلُ',
      'الآخِرُ',
      'الظَّاهِرُ',
      'الْبَاطِنُ',
      'الْوَالِي',
      'الْمُتَعَالِي',
      'الْبَرُّ',
      'التَّوَابُ',
      'الْمُنْتَقِمُ',
      'العَفُوُ',
      'الرَّؤُوفُ',
      'مَالِكُ الْمُلْكُ',
      'ذُو الْجَلاَلِ وَالإكْرَامِ',
      'الْمُقْسِطُ',
      'الْجَامِعُ',
      'الْغَنِيُّ',
      'الْمُغْنِي',
      'اَلْمَانِعُ',
      'الضَّارَّ',
      'النَّافِعُ',
      'النُّورُ',
      'الْهَادِي',
      'الْبَدِيعُ',
      'الْبَاقِي',
      'الْوَارِثُ',
      'الرَّشِيدُ',
      'الصَّبُورُ',
    ],
  },
  surah_fatiha: {
    roman: [
      'Bismillaahir Rahmaanir Raheem',
      "Al hamdu lillaahi Rabbil 'aalameen",
      'Ar-Rahmaanir-Raheem',
      'Maaliki Yawmid-Deen',
      "Iyyaaka na'budu wa lyyaaka nasta'een",
      'Ihdinas siraatal mustaqeem',
      "Siraatal ladheena an'amta 'alaihim ghayril maghdoobi 'alaihim wa lad-daaalleen",
    ],
    urdu: [
      'بِسْمِ اللَّهِ الرَّحْمَٰنِ الرَّحِيمِ',
      'الْحَمْدُ لِلَّهِ رَبِّ الْعَالَمِينَ',
      'الرَّحْمَٰنِ الرَّحِيمِ',
      'مَالِكِ يَوْمِ الدِّينِ',
      'إِيَّاكَ نَعْبُدُ وَإِيَّاكَ نَسْتَعِينُ',
      'اهْدِنَا الصِّرَاطَ الْمُسْتَقِيمَ',
      'صِرَاطَ الَّذِينَ أَنْعَمْتَ عَلَيْهِمْ غَيْرِ الْمَغْضُوبِ عَلَيْهِمْ وَلَا الضَّالِّينَ',
    ],
  },
}

let currentIndex = 0
let currentSequence = []
let initialFont = 28
let allNames = data['99_names'].urdu // Default to 99 names in Urdu
let language = 0
let breakpoint = 5 // Default breakpoint value
let lastBreakpointIndex = 0
let currentSelection = '99_names' // Default selection

function startGame() {
  currentIndex = 0
  currentSequence = []
  allNames = data[currentSelection][language === 0 ? 'urdu' : 'roman']
  displayNextSequence()
}

function displayNextSequence() {
  const sequenceContainer = document.getElementById('sequence')
  const optionsContainer = document.getElementById('options')
  const messageContainer = document.getElementById('message')

  // Clear previous options and message
  optionsContainer.style.display = 'none'
  messageContainer.innerText = ''

  // Display the current sequence
  const nameElement = document.createElement('span')
  nameElement.innerText = allNames[currentIndex]
  nameElement.classList.add('increasable')
  sequenceContainer.appendChild(nameElement)
  currentSequence.push(allNames[currentIndex])

  // Save progress at breakpoints
  if ((currentIndex + 1) % breakpoint === 0) {
    lastBreakpointIndex = currentIndex + 1
  }

  // If the sequence has reached its end, show options to choose the next name
  if (currentSequence.length < allNames.length) {
    setTimeout(() => {
      optionsContainer.style.display = 'flex'

      // Shuffle options and include the correct next name
      let options = [allNames[currentIndex + 1]]
      while (options.length < 4) {
        const randomName = allNames[Math.floor(Math.random() * allNames.length)]
        if (
          !options.includes(randomName) &&
          randomName !== allNames[currentIndex + 1]
        ) {
          options.push(randomName)
        }
      }

      options = shuffle(options)

      // Display options on buttons
      options.forEach((name, i) => {
        document.getElementById(`option${i + 1}`).innerText = name
      })
    }, 1000)
  }
}

function checkAnswer(option) {
  const selectedName = document.getElementById(`option${option}`).innerText
  const messageContainer = document.getElementById('message')

  if (selectedName === allNames[currentIndex + 1]) {
    // Correct answer
    currentIndex++
    if (currentIndex < allNames.length - 1) {
      displayNextSequence()
    } else {
      displayNextSequence()
      messageContainer.innerText =
        "Congratulations! You've learned all the names!"
    }
  } else {
    // Wrong answer, reset to the last breakpoint
    messageContainer.innerText =
      'Wrong answer! Restarting from last breakpoint...'
    resetGame()
  }
}

function resetGame() {
  setTimeout(() => {
    currentIndex = lastBreakpointIndex
    currentSequence = []
    const sequenceContainer = document.getElementById('sequence')
    sequenceContainer.innerHTML = ''
    for (let i = 0; i < currentIndex; i++) {
      const nameElement = document.createElement('span')
      nameElement.innerText = allNames[i]
      nameElement.classList.add('increasable')
      sequenceContainer.appendChild(nameElement)
      currentSequence.push(allNames[i])
    }
    displayNextSequence()
  }, 1000)
}

function shuffle(array) {
  for (let i = array.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1))
    ;[array[i], array[j]] = [array[j], array[i]]
  }
  return array
}

function increaseFontSize() {
  initialFont += 2
  const elementsToIncrease = document.querySelectorAll('.increasable')
  elementsToIncrease.forEach((element) => {
    element.style.fontSize = initialFont + 'px'
  })
}

function decreaseFontSize() {
  initialFont -= 2
  const elementsToIncrease = document.querySelectorAll('.increasable')
  elementsToIncrease.forEach((element) => {
    element.style.fontSize = initialFont + 'px'
  })
}

function changeLanguage() {
  language = language === 0 ? 1 : 0
  allNames = data[currentSelection][language === 0 ? 'urdu' : 'roman']
  resetGame()
}

function setBreakpoint(value) {
  breakpoint = value
  lastBreakpointIndex = 0 // Reset the last breakpoint index
  resetGame() // Restart the game to apply the new breakpoint
}

function changeSelection(selection) {
  currentSelection = selection
  allNames = data[currentSelection][language === 0 ? 'urdu' : 'roman']
  lastBreakpointIndex = 0
  resetGame()
}

window.onload = startGame
